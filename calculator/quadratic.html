<!-- Quadratic Formula Calculator Page -->
<!-- This combines the base calculator template with the Quadratic Formula calculator component -->

<div class="max-w-4xl mt-6 mx-auto">
    <!-- Back Button -->
    <div class="mb-8">
        <button 
            hx-get="/fragments/home.html"
            hx-target="#content-body"
            hx-swap="innerHTML"
            class="group inline-flex items-center px-4 py-2.5 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700/50 hover:border-slate-600/50 rounded-lg text-sm font-medium text-gray-300 hover:text-white transition-all duration-200 shadow-sm hover:shadow-md">
            <svg class="w-5 h-5 mr-2 group-hover:-translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            <span>Back to Calculators</span>
        </button>
    </div>

    <!-- Calculator Header -->
    <div class="mb-8">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-purple-500 to-blue-500 rounded-xl mb-4">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
            </svg>
        </div>
        <h1 class="text-4xl font-bold mb-3">Quadratic Formula Calculator</h1>
        <p class="text-gray-400 text-lg">Solve quadratic equations using the standard quadratic formula</p>
    </div>

    <!-- Calculator Content Area -->
    <div class="bg-slate-800/50 rounded-2xl p-6 md:p-8 border border-slate-700/50 backdrop-blur-sm">
        <!-- Quadratic Formula Calculator Form -->
        <form id="quadratic-form" class="space-y-6" onsubmit="calculateQuadratic(event)">
            <!-- Equation Display -->
            <div class="bg-slate-900/50 rounded-lg p-4 border border-slate-600/30">
                <p class="text-center text-gray-300 font-mono text-lg">
                    <span id="equation-display">ax² + bx + c = 0</span>
                </p>
            </div>

            <!-- Coefficients Input -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Coefficient a -->
                <div>
                    <label for="coefficient-a" class="block text-sm font-medium text-gray-300 mb-2">
                        Coefficient <span class="font-mono text-purple-400">a</span>
                    </label>
                    <input 
                        type="number" 
                        id="coefficient-a" 
                        name="coefficient-a"
                        step="any"
                        placeholder="1"
                        value="1"
                        class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center font-mono text-lg">
                    <p class="text-xs text-gray-500 mt-1 text-center">(coefficient of x²)</p>
                </div>

                <!-- Coefficient b -->
                <div>
                    <label for="coefficient-b" class="block text-sm font-medium text-gray-300 mb-2">
                        Coefficient <span class="font-mono text-blue-400">b</span>
                    </label>
                    <input 
                        type="number" 
                        id="coefficient-b" 
                        name="coefficient-b"
                        step="any"
                        placeholder="0"
                        value="0"
                        class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center font-mono text-lg">
                    <p class="text-xs text-gray-500 mt-1 text-center">(coefficient of x)</p>
                </div>

                <!-- Coefficient c -->
                <div>
                    <label for="coefficient-c" class="block text-sm font-medium text-gray-300 mb-2">
                        Coefficient <span class="font-mono text-cyan-400">c</span>
                    </label>
                    <input 
                        type="number" 
                        id="coefficient-c" 
                        name="coefficient-c"
                        step="any"
                        placeholder="0"
                        value="0"
                        class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-center font-mono text-lg">
                    <p class="text-xs text-gray-500 mt-1 text-center">(constant term)</p>
                </div>
            </div>

            <!-- Quick Examples -->
            <div>
                <p class="text-xs text-gray-400 mb-2">Quick Examples:</p>
                <div class="flex flex-wrap gap-2">
                    <button type="button" onclick="setCoefficients(1, -5, 6)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">x² - 5x + 6 = 0</button>
                    <button type="button" onclick="setCoefficients(1, 0, -4)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">x² - 4 = 0</button>
                    <button type="button" onclick="setCoefficients(2, 4, 0)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">2x² + 4x = 0</button>
                    <button type="button" onclick="setCoefficients(1, 2, 1)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">x² + 2x + 1 = 0</button>
                    <button type="button" onclick="setCoefficients(1, 1, 1)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">x² + x + 1 = 0</button>
                </div>
            </div>

            <!-- Calculate Button -->
            <button 
                type="submit"
                class="w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg font-semibold text-white hover:from-purple-700 hover:to-blue-700 transition-all shadow-lg hover:shadow-xl">
                Solve Equation
            </button>
        </form>

        <!-- Result Display -->
        <div id="quadratic-result" class="hidden mt-8">
            <div class="bg-gradient-to-br from-slate-700/50 to-slate-800/50 rounded-xl p-6 border border-slate-600/50">
                <div class="space-y-6">
                    <!-- Discriminant -->
                    <div class="pb-4 border-b border-slate-600/50">
                        <p class="text-sm text-gray-400 mb-2">Discriminant (Δ)</p>
                        <p class="text-2xl font-bold text-purple-400 font-mono" id="discriminant-value"></p>
                        <p class="text-xs text-gray-500 mt-1" id="discriminant-note"></p>
                    </div>

                    <!-- Solutions -->
                    <div>
                        <h4 class="text-sm font-semibold text-gray-300 mb-3">Solutions</h4>
                        <div id="solutions-display" class="space-y-3">
                            <!-- Solutions will be inserted here -->
                        </div>
                    </div>

                    <!-- Calculation Steps -->
                    <div class="mt-4 pt-4 border-t border-slate-600/50">
                        <h4 class="text-sm font-semibold text-gray-300 mb-2">Calculation Steps</h4>
                        <div id="calculation-steps" class="text-sm text-gray-400 font-mono bg-slate-900/30 rounded p-3 space-y-1">
                            <!-- Calculation steps will be shown here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Formula Info Section -->
    <div class="mt-8">
        <div class="bg-slate-800/30 rounded-xl p-6 border border-slate-700/50">
            <h3 class="text-xl font-bold mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                About the Quadratic Formula
            </h3>
            <div class="space-y-4 text-gray-300">
                <p>
                    The quadratic formula is used to solve quadratic equations of the form 
                    <span class="font-mono text-purple-400">ax² + bx + c = 0</span>, 
                    where <span class="font-mono text-purple-400">a ≠ 0</span>.
                </p>
                
                <div class="bg-slate-900/50 rounded-lg p-4 font-mono text-center space-y-2">
                    <p class="text-lg text-purple-300">x = (-b ± √(b² - 4ac)) / 2a</p>
                    <p class="text-sm text-gray-400">Δ = b² - 4ac (discriminant)</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30">
                        <p class="text-sm font-semibold text-green-400 mb-2">Δ > 0</p>
                        <p class="text-xs text-gray-400">
                            Two distinct real solutions
                        </p>
                    </div>
                    <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30">
                        <p class="text-sm font-semibold text-yellow-400 mb-2">Δ = 0</p>
                        <p class="text-xs text-gray-400">
                            One real solution (repeated root)
                        </p>
                    </div>
                    <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30">
                        <p class="text-sm font-semibold text-red-400 mb-2">Δ < 0</p>
                        <p class="text-xs text-gray-400">
                            Two complex solutions
                        </p>
                    </div>
                </div>
                
                <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30 mt-4">
                    <p class="text-sm font-semibold text-purple-400 mb-2">Examples</p>
                    <ul class="text-xs text-gray-400 space-y-1">
                        <li>• <span class="font-mono">x² - 5x + 6 = 0</span> → x = 2, x = 3</li>
                        <li>• <span class="font-mono">x² - 4 = 0</span> → x = 2, x = -2</li>
                        <li>• <span class="font-mono">x² + 2x + 1 = 0</span> → x = -1 (repeated)</li>
                        <li>• <span class="font-mono">x² + x + 1 = 0</span> → Complex solutions</li>
                    </ul>
                </div>
                
                <p class="text-sm text-gray-400 mt-4">
                    <strong class="text-gray-300">Note:</strong> 
                    The discriminant (Δ = b² - 4ac) determines the nature of the solutions. 
                    If Δ is negative, the solutions are complex numbers involving the imaginary unit i = √(-1).
                </p>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Quadratic Formula Calculation -->
<script>
    function updateEquationDisplay() {
        const a = parseFloat(document.getElementById('coefficient-a').value) || 0;
        const b = parseFloat(document.getElementById('coefficient-b').value) || 0;
        const c = parseFloat(document.getElementById('coefficient-c').value) || 0;
        
        let equation = '';
        
        // Build equation string
        if (a !== 0) {
            if (a === 1) equation += 'x²';
            else if (a === -1) equation += '-x²';
            else equation += a + 'x²';
        }
        
        if (b !== 0) {
            if (equation !== '') equation += ' ';
            if (b > 0 && equation !== '') equation += '+ ';
            if (b === 1) equation += 'x';
            else if (b === -1) equation += '-x';
            else equation += b + 'x';
        }
        
        if (c !== 0) {
            if (equation !== '') equation += ' ';
            if (c > 0 && equation !== '') equation += '+ ';
            equation += c;
        }
        
        if (equation === '') equation = '0';
        equation += ' = 0';
        
        document.getElementById('equation-display').textContent = equation;
    }
    
    function setCoefficients(a, b, c) {
        document.getElementById('coefficient-a').value = a;
        document.getElementById('coefficient-b').value = b;
        document.getElementById('coefficient-c').value = c;
        updateEquationDisplay();
    }
    
    function formatNumber(num, decimals = 6) {
        // Round to avoid floating point errors
        const rounded = Math.round(num * Math.pow(10, decimals)) / Math.pow(10, decimals);
        
        // Format nicely
        if (Math.abs(rounded) < 0.000001 && rounded !== 0) {
            return rounded.toExponential(3);
        }
        
        // Check if it's essentially an integer
        if (Math.abs(rounded - Math.round(rounded)) < 0.000001) {
            return Math.round(rounded).toString();
        }
        
        return rounded.toString();
    }
    
    function formatComplex(real, imag) {
        if (Math.abs(imag) < 0.000001) {
            return formatNumber(real);
        }
        if (Math.abs(real) < 0.000001) {
            if (Math.abs(imag - 1) < 0.000001) return 'i';
            if (Math.abs(imag + 1) < 0.000001) return '-i';
            return formatNumber(imag) + 'i';
        }
        
        const imagStr = Math.abs(imag - 1) < 0.000001 ? 'i' : 
                       Math.abs(imag + 1) < 0.000001 ? '-i' :
                       formatNumber(imag) + 'i';
        
        if (imag > 0) {
            return formatNumber(real) + ' + ' + imagStr;
        } else {
            return formatNumber(real) + ' - ' + imagStr.replace('-', '');
        }
    }
    
    function calculateQuadratic(event) {
        event.preventDefault();
        
        const a = parseFloat(document.getElementById('coefficient-a').value);
        const b = parseFloat(document.getElementById('coefficient-b').value);
        const c = parseFloat(document.getElementById('coefficient-c').value);
        
        // Validate input
        if (isNaN(a) || a === 0) {
            alert('Coefficient a must be a non-zero number.');
            return;
        }
        
        if (isNaN(b) || isNaN(c)) {
            alert('Please enter valid numbers for all coefficients.');
            return;
        }
        
        // Calculate discriminant
        const discriminant = b * b - 4 * a * c;
        const twoA = 2 * a;
        
        // Display discriminant
        document.getElementById('discriminant-value').textContent = 'Δ = ' + formatNumber(discriminant);
        
        let discriminantNote = '';
        let solutionsHTML = '';
        let stepsHTML = '';
        
        // Build calculation steps
        stepsHTML += `Given: a = ${formatNumber(a)}, b = ${formatNumber(b)}, c = ${formatNumber(c)}<br>`;
        stepsHTML += `Δ = b² - 4ac<br>`;
        stepsHTML += `Δ = ${formatNumber(b)}² - 4(${formatNumber(a)})(${formatNumber(c)})<br>`;
        stepsHTML += `Δ = ${formatNumber(b * b)} - ${formatNumber(4 * a * c)}<br>`;
        stepsHTML += `Δ = ${formatNumber(discriminant)}<br><br>`;
        
        if (discriminant > 0) {
            // Two distinct real solutions
            discriminantNote = 'Two distinct real solutions';
            
            const sqrtDiscriminant = Math.sqrt(discriminant);
            const x1 = (-b + sqrtDiscriminant) / twoA;
            const x2 = (-b - sqrtDiscriminant) / twoA;
            
            solutionsHTML = `
                <div class="bg-green-900/20 border border-green-700/30 rounded-lg p-4">
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-green-400 font-semibold">x₁ =</span>
                            <span class="text-white font-mono text-lg">${formatNumber(x1)}</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-green-400 font-semibold">x₂ =</span>
                            <span class="text-white font-mono text-lg">${formatNumber(x2)}</span>
                        </div>
                    </div>
                </div>
            `;
            
            stepsHTML += `x = (-b ± √Δ) / 2a<br>`;
            stepsHTML += `x = (-${formatNumber(b)} ± ${formatNumber(sqrtDiscriminant)}) / ${formatNumber(twoA)}<br>`;
            stepsHTML += `x₁ = (-${formatNumber(b)} + ${formatNumber(sqrtDiscriminant)}) / ${formatNumber(twoA)} = ${formatNumber(x1)}<br>`;
            stepsHTML += `x₂ = (-${formatNumber(b)} - ${formatNumber(sqrtDiscriminant)}) / ${formatNumber(twoA)} = ${formatNumber(x2)}`;
            
        } else if (discriminant === 0) {
            // One real solution (repeated root)
            discriminantNote = 'One real solution (repeated root)';
            
            const x = -b / twoA;
            
            solutionsHTML = `
                <div class="bg-yellow-900/20 border border-yellow-700/30 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <span class="text-yellow-400 font-semibold">x =</span>
                        <span class="text-white font-mono text-lg">${formatNumber(x)}</span>
                    </div>
                    <p class="text-xs text-yellow-300/70 mt-1">(Repeated root)</p>
                </div>
            `;
            
            stepsHTML += `x = -b / 2a<br>`;
            stepsHTML += `x = -${formatNumber(b)} / ${formatNumber(twoA)}<br>`;
            stepsHTML += `x = ${formatNumber(x)}`;
            
        } else {
            // Two complex solutions
            discriminantNote = 'Two complex solutions';
            
            const realPart = -b / twoA;
            const imagPart = Math.sqrt(-discriminant) / twoA;
            
            solutionsHTML = `
                <div class="bg-red-900/20 border border-red-700/30 rounded-lg p-4">
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-red-400 font-semibold">x₁ =</span>
                            <span class="text-white font-mono text-lg">${formatComplex(realPart, imagPart)}</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-red-400 font-semibold">x₂ =</span>
                            <span class="text-white font-mono text-lg">${formatComplex(realPart, -imagPart)}</span>
                        </div>
                    </div>
                </div>
            `;
            
            stepsHTML += `x = (-b ± i√|Δ|) / 2a<br>`;
            stepsHTML += `x = (-${formatNumber(b)} ± i${formatNumber(Math.sqrt(-discriminant))}) / ${formatNumber(twoA)}<br>`;
            stepsHTML += `x₁ = ${formatComplex(realPart, imagPart)}<br>`;
            stepsHTML += `x₂ = ${formatComplex(realPart, -imagPart)}`;
        }
        
        document.getElementById('discriminant-note').textContent = discriminantNote;
        document.getElementById('solutions-display').innerHTML = solutionsHTML;
        document.getElementById('calculation-steps').innerHTML = stepsHTML;
        
        // Show result
        document.getElementById('quadratic-result').classList.remove('hidden');
        document.getElementById('quadratic-result').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // Update equation display when coefficients change
    document.addEventListener('DOMContentLoaded', function() {
        ['coefficient-a', 'coefficient-b', 'coefficient-c'].forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener('input', updateEquationDisplay);
            }
        });
        updateEquationDisplay();
    });
</script>

