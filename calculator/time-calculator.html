<!-- Time Calculator Page -->
<!-- A calculator to add and subtract time durations -->

<div class="max-w-4xl mt-6 mx-auto">
    <!-- Back Button -->
    <div class="mb-8">
        <button 
            hx-get="/fragments/home.html"
            hx-target="#content-body"
            hx-swap="innerHTML"
            class="group inline-flex items-center px-4 py-2.5 bg-slate-800/50 hover:bg-slate-700/50 border border-slate-700/50 hover:border-slate-600/50 rounded-lg text-sm font-medium text-gray-300 hover:text-white transition-all duration-200 shadow-sm hover:shadow-md">
            <svg class="w-5 h-5 mr-2 group-hover:-translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            <span>Back to Calculators</span>
        </button>
    </div>

    <!-- Calculator Header -->
    <div class="mb-8">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl mb-4">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
        </div>
        <h1 class="text-4xl font-bold mb-3">Time Calculator</h1>
        <p class="text-gray-400 text-lg">Add and subtract hours, minutes, and seconds</p>
    </div>

    <!-- Calculator Content Area -->
    <div class="bg-slate-800/50 rounded-2xl p-6 md:p-8 border border-slate-700/50 backdrop-blur-sm">
        <!-- Time Calculator Form -->
        <form id="time-calculator-form" class="space-y-6" onsubmit="event.preventDefault()">
            <!-- Time 1 Input -->
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Time 1</label>
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label for="time1-hours" class="block text-xs text-gray-400 mb-1 text-center">Hours</label>
                        <input 
                            type="number" 
                            id="time1-hours" 
                            min="0"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                    <div>
                        <label for="time1-minutes" class="block text-xs text-gray-400 mb-1 text-center">Minutes</label>
                        <input 
                            type="number" 
                            id="time1-minutes" 
                            min="0"
                            max="59"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                    <div>
                        <label for="time1-seconds" class="block text-xs text-gray-400 mb-1 text-center">Seconds</label>
                        <input 
                            type="number" 
                            id="time1-seconds" 
                            min="0"
                            max="59"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                </div>
            </div>

            <!-- Operation Display -->
            <div class="flex justify-center">
                <div id="operation-display" class="text-2xl font-bold text-gray-400">+</div>
            </div>

            <!-- Time 2 Input -->
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-3">Time 2</label>
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label for="time2-hours" class="block text-xs text-gray-400 mb-1 text-center">Hours</label>
                        <input 
                            type="number" 
                            id="time2-hours" 
                            min="0"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                    <div>
                        <label for="time2-minutes" class="block text-xs text-gray-400 mb-1 text-center">Minutes</label>
                        <input 
                            type="number" 
                            id="time2-minutes" 
                            min="0"
                            max="59"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                    <div>
                        <label for="time2-seconds" class="block text-xs text-gray-400 mb-1 text-center">Seconds</label>
                        <input 
                            type="number" 
                            id="time2-seconds" 
                            min="0"
                            max="59"
                            value="0"
                            class="w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent text-center font-mono text-lg">
                    </div>
                </div>
            </div>

            <!-- Operation Buttons -->
            <div class="flex flex-wrap justify-center gap-4">
                <button 
                    type="button"
                    onclick="calculateTime('add')"
                    class="px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg font-semibold text-white hover:from-green-700 hover:to-emerald-700 transition-all shadow-lg hover:shadow-xl flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    Add Times
                </button>
                
                <button 
                    type="button"
                    onclick="calculateTime('subtract')"
                    class="px-6 py-3 bg-gradient-to-r from-red-600 to-pink-600 rounded-lg font-semibold text-white hover:from-red-700 hover:to-pink-700 transition-all shadow-lg hover:shadow-xl flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                    </svg>
                    Subtract Times
                </button>
            </div>

            <!-- Quick Examples -->
            <div>
                <p class="text-xs text-gray-400 mb-2 text-center">Quick Examples:</p>
                <div class="flex flex-wrap justify-center gap-2">
                    <button type="button" onclick="setExample(1, 30, 0, 0, 45, 0)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">1:30:00 + 0:45:00</button>
                    <button type="button" onclick="setExample(2, 15, 30, 1, 20, 45)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">2:15:30 + 1:20:45</button>
                    <button type="button" onclick="setExample(3, 0, 0, 0, 30, 0)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">3:00:00 - 0:30:00</button>
                    <button type="button" onclick="setExample(0, 45, 30, 0, 20, 15)" class="px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 rounded text-xs text-gray-300 hover:text-white transition-colors">0:45:30 - 0:20:15</button>
                </div>
            </div>
        </form>

        <!-- Result Display -->
        <div id="time-result" class="hidden mt-8">
            <div class="bg-gradient-to-br from-slate-700/50 to-slate-800/50 rounded-xl p-6 border border-slate-600/50">
                <div class="space-y-4">
                    <!-- Result -->
                    <div class="pb-4 border-b border-slate-600/50">
                        <p class="text-sm text-gray-400 mb-2">Result</p>
                        <p class="text-4xl font-bold text-teal-400 font-mono" id="result-display"></p>
                        <p class="text-sm text-gray-400 mt-2 font-mono" id="result-alternative"></p>
                    </div>

                    <!-- Calculation Breakdown -->
                    <div>
                        <h4 class="text-sm font-semibold text-gray-300 mb-2">Calculation</h4>
                        <div id="calculation-breakdown" class="text-sm text-gray-400 font-mono bg-slate-900/30 rounded p-3 space-y-1">
                            <!-- Calculation will be shown here -->
                        </div>
                    </div>

                    <!-- Conversion Display -->
                    <div class="mt-4 pt-4 border-t border-slate-600/50">
                        <h4 class="text-sm font-semibold text-gray-300 mb-3">Conversions</h4>
                        <div id="conversion-display" class="grid grid-cols-1 md:grid-cols-3 gap-3">
                            <!-- Conversions will be shown here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Formula Info Section -->
    <div class="mt-8">
        <div class="bg-slate-800/30 rounded-xl p-6 border border-slate-700/50">
            <h3 class="text-xl font-bold mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                About Time Calculations
            </h3>
            <div class="space-y-4 text-gray-300">
                <p>
                    This calculator allows you to add or subtract time durations. It automatically normalizes 
                    the result, converting seconds to minutes and minutes to hours as needed.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30">
                        <p class="text-sm font-semibold text-teal-400 mb-2">Adding Time</p>
                        <ul class="text-xs text-gray-400 space-y-1">
                            <li>• Example: 1:30:00 + 0:45:00 = 2:15:00</li>
                            <li>• Automatically handles overflow</li>
                            <li>• 60 seconds = 1 minute</li>
                            <li>• 60 minutes = 1 hour</li>
                        </ul>
                    </div>
                    <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30">
                        <p class="text-sm font-semibold text-teal-400 mb-2">Subtracting Time</p>
                        <ul class="text-xs text-gray-400 space-y-1">
                            <li>• Example: 2:00:00 - 0:30:00 = 1:30:00</li>
                            <li>• Automatically handles borrowing</li>
                            <li>• Negative results are shown</li>
                            <li>• Useful for time differences</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-slate-700/30 rounded-lg p-4 border border-slate-600/30 mt-4">
                    <p class="text-sm font-semibold text-teal-400 mb-2">Common Uses</p>
                    <ul class="text-xs text-gray-400 space-y-1">
                        <li>• Calculate total duration of multiple activities</li>
                        <li>• Find time differences between events</li>
                        <li>• Add breaks to work sessions</li>
                        <li>• Calculate elapsed time in projects</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Time Calculator -->
<script>
    function setExample(h1, m1, s1, h2, m2, s2) {
        document.getElementById('time1-hours').value = h1;
        document.getElementById('time1-minutes').value = m1;
        document.getElementById('time1-seconds').value = s1;
        document.getElementById('time2-hours').value = h2;
        document.getElementById('time2-minutes').value = m2;
        document.getElementById('time2-seconds').value = s2;
    }
    
    function getTimeInput(timeNum) {
        const hours = parseInt(document.getElementById(`time${timeNum}-hours`).value) || 0;
        const minutes = parseInt(document.getElementById(`time${timeNum}-minutes`).value) || 0;
        const seconds = parseInt(document.getElementById(`time${timeNum}-seconds`).value) || 0;
        
        // Normalize inputs
        const totalSeconds = hours * 3600 + minutes * 60 + seconds;
        
        return {
            hours: hours,
            minutes: minutes,
            seconds: seconds,
            totalSeconds: totalSeconds
        };
    }
    
    function normalizeTime(totalSeconds) {
        const isNegative = totalSeconds < 0;
        const absSeconds = Math.abs(totalSeconds);
        
        const hours = Math.floor(absSeconds / 3600);
        const minutes = Math.floor((absSeconds % 3600) / 60);
        const seconds = absSeconds % 60;
        
        return {
            hours: isNegative ? -hours : hours,
            minutes: isNegative ? -minutes : minutes,
            seconds: isNegative ? -seconds : seconds,
            totalSeconds: totalSeconds,
            isNegative: isNegative,
            display: `${isNegative ? '-' : ''}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`
        };
    }
    
    function formatTime(totalSeconds) {
        const normalized = normalizeTime(totalSeconds);
        return normalized;
    }
    
    function calculateTime(operation) {
        const time1 = getTimeInput(1);
        const time2 = getTimeInput(2);
        
        let resultSeconds;
        let operationSymbol;
        
        if (operation === 'add') {
            resultSeconds = time1.totalSeconds + time2.totalSeconds;
            operationSymbol = '+';
        } else {
            resultSeconds = time1.totalSeconds - time2.totalSeconds;
            operationSymbol = '-';
        }
        
        const result = formatTime(resultSeconds);
        
        // Update operation display
        document.getElementById('operation-display').textContent = operationSymbol;
        
        // Display result
        document.getElementById('result-display').textContent = result.display;
        
        // Show alternative formats
        const absResult = formatTime(Math.abs(resultSeconds));
        let alternativeText = '';
        
        if (result.totalSeconds !== 0) {
            const totalMinutes = Math.floor(Math.abs(result.totalSeconds) / 60);
            const totalHours = Math.floor(Math.abs(result.totalSeconds) / 3600);
            const days = Math.floor(Math.abs(result.totalSeconds) / 86400);
            
            const parts = [];
            if (days > 0) parts.push(`${days} day${days !== 1 ? 's' : ''}`);
            if (totalHours > 0) parts.push(`${totalHours} hour${totalHours !== 1 ? 's' : ''}`);
            if (totalMinutes > 0) parts.push(`${totalMinutes} minute${totalMinutes !== 1 ? 's' : ''}`);
            if (result.seconds !== 0 || parts.length === 0) {
                parts.push(`${Math.abs(result.seconds)} second${Math.abs(result.seconds) !== 1 ? 's' : ''}`);
            }
            
            alternativeText = (result.isNegative ? '-' : '') + parts.join(', ');
        } else {
            alternativeText = '0 seconds';
        }
        
        document.getElementById('result-alternative').textContent = alternativeText;
        
        // Calculation breakdown
        const breakdown = [];
        breakdown.push(`Time 1: ${formatTime(time1.totalSeconds).display} (${time1.totalSeconds} seconds)`);
        breakdown.push(`Time 2: ${formatTime(time2.totalSeconds).display} (${time2.totalSeconds} seconds)`);
        breakdown.push(`Operation: Time 1 ${operationSymbol} Time 2`);
        breakdown.push(`Total seconds: ${result.totalSeconds}`);
        breakdown.push(`Result: ${result.display}`);
        
        document.getElementById('calculation-breakdown').innerHTML = breakdown.join('<br>');
        
        // Conversions
        const conversions = [];
        
        if (result.totalSeconds !== 0) {
            const absSeconds = Math.abs(result.totalSeconds);
            const totalMinutes = Math.floor(absSeconds / 60);
            const totalHours = Math.floor(absSeconds / 3600);
            const days = Math.floor(absSeconds / 86400);
            
            conversions.push(`
                <div class="bg-slate-700/30 rounded-lg p-3 border border-slate-600/30">
                    <p class="text-xs text-gray-400">Total Seconds</p>
                    <p class="text-sm font-semibold text-teal-300">${result.totalSeconds.toLocaleString()}</p>
                </div>
            `);
            
            if (totalMinutes > 0) {
                conversions.push(`
                    <div class="bg-slate-700/30 rounded-lg p-3 border border-slate-600/30">
                        <p class="text-xs text-gray-400">Total Minutes</p>
                        <p class="text-sm font-semibold text-teal-300">${totalMinutes.toLocaleString()}</p>
                    </div>
                `);
            }
            
            if (totalHours > 0) {
                conversions.push(`
                    <div class="bg-slate-700/30 rounded-lg p-3 border border-slate-600/30">
                        <p class="text-xs text-gray-400">Total Hours</p>
                        <p class="text-sm font-semibold text-teal-300">${totalHours.toLocaleString()}</p>
                    </div>
                `);
            }
            
            if (days > 0) {
                conversions.push(`
                    <div class="bg-slate-700/30 rounded-lg p-3 border border-slate-600/30">
                        <p class="text-xs text-gray-400">Total Days</p>
                        <p class="text-sm font-semibold text-teal-300">${days.toLocaleString()}</p>
                    </div>
                `);
            }
        }
        
        document.getElementById('conversion-display').innerHTML = conversions.join('');
        
        // Show result
        document.getElementById('time-result').classList.remove('hidden');
        document.getElementById('time-result').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // Auto-normalize inputs when they exceed limits
    ['time1-hours', 'time1-minutes', 'time1-seconds', 'time2-hours', 'time2-minutes', 'time2-seconds'].forEach(id => {
        const input = document.getElementById(id);
        if (input) {
            input.addEventListener('input', function() {
                if (this.id.includes('minutes') || this.id.includes('seconds')) {
                    let value = parseInt(this.value) || 0;
                    const max = this.id.includes('minutes') ? 59 : 59;
                    
                    if (value > max) {
                        const overflow = Math.floor(value / (max + 1));
                        value = value % (max + 1);
                        
                        // Handle overflow
                        const timeNum = this.id.includes('time1') ? '1' : '2';
                        const unit = this.id.includes('minutes') ? 'hours' : 'minutes';
                        const parentInput = document.getElementById(`time${timeNum}-${unit}`);
                        const currentValue = parseInt(parentInput.value) || 0;
                        parentInput.value = currentValue + overflow;
                        
                        // Trigger normalization for parent
                        parentInput.dispatchEvent(new Event('input'));
                    }
                    
                    if (value < 0) value = 0;
                    this.value = value;
                }
            });
        }
    });
</script>

